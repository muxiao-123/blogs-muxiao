<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mongo | Blogs-Muxiao</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="map map map good good">
    
    <link rel="preload" href="/blogs-muxiao/assets/css/0.styles.1597e3cd.css" as="style"><link rel="preload" href="/blogs-muxiao/assets/js/app.a806e497.js" as="script"><link rel="preload" href="/blogs-muxiao/assets/js/2.78b8a33c.js" as="script"><link rel="preload" href="/blogs-muxiao/assets/js/27.97108fd7.js" as="script"><link rel="prefetch" href="/blogs-muxiao/assets/js/10.52a07cd0.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/11.b30c08a7.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/12.3e728434.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/13.1af5f6b2.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/14.2e4a2fb6.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/15.b1f5407a.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/16.510e3c04.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/17.fc6ebf64.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/18.f0519518.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/19.b50ef5e7.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/20.754d23f7.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/21.f480af4d.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/22.91e6c181.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/23.13478913.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/24.ad06b715.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/25.1026cefa.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/26.f1c86ef0.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/28.ca5581ec.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/29.958d3dc1.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/3.bc3b08de.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/30.0f788922.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/31.815636a0.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/32.89d863b8.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/33.4f964b9b.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/34.93743e4c.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/35.987c0b2f.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/36.3e5df56b.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/37.88fa2c53.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/38.fcbdcaf2.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/39.70e5c939.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/4.11957e18.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/5.1d0585d4.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/6.f2a96706.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/7.ba72b951.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/8.48c4a4d6.js"><link rel="prefetch" href="/blogs-muxiao/assets/js/9.42749e8e.js">
    <link rel="stylesheet" href="/blogs-muxiao/assets/css/0.styles.1597e3cd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blogs-muxiao/" class="home-link router-link-active"><!----> <span class="site-name">Blogs-Muxiao</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blogs-muxiao/no-base/mongo/mine/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs-muxiao/no-base/mongo/mine/" class="nav-link">
  Chinese
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blogs-muxiao/no-base/mongo/mine/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blogs-muxiao/no-base/mongo/mine/" class="nav-link">
  Chinese
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mine</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Css</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Html</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vite</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Eslint</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Plugins</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Markdown</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Issues</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>no-base</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs-muxiao/no-base/" aria-current="page" class="sidebar-link">No-Base</a></li><li><a href="/blogs-muxiao/no-base/envirament/" class="sidebar-link">环境变量</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blogs-muxiao/no-base/mongo/" aria-current="page" class="active sidebar-link">Mongo</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blogs-muxiao/no-base/nginx/" class="sidebar-link">Nginx</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blogs-muxiao/no-base/npm/" class="sidebar-link">Npm</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="mongo"><a href="#mongo" class="header-anchor">#</a> Mongo</h3> <ol><li>查看当前连接数
<code>db.serverStatus().connections</code></li></ol> <h4 id="redis"><a href="#redis" class="header-anchor">#</a> redis</h4> <ol><li>启动 <code>redis</code> 服务</li></ol> <p><code>redis-serve.exe</code></p> <ol start="2"><li>可指定配置文件</li></ol> <p><code>redis-serve.exe redis.windows.conf</code></p> <ol start="3"><li>连接 <code>redis</code></li></ol> <p><code>redis-cli.exe</code>
有时候中文会乱码  要在 <code>redis-cli</code> 后面加上 <code>--raw</code></p> <p>可指定主机 端口号 密码</p> <p><code>redis-cli.exe -h 127.0.0.1 -p 6379 -a password</code></p> <p>检查 连接 <code>ping</code></p> <p>默认数据库为0  数据库是以0为起点 的增量1</p> <p><code>set db_number</code> 0 设置当前数据库选择
<code>get db_number</code> 得到当前数据库编号
<code>select</code> 1 切换到1号数据库</p> <p><code>redis-cli shutdown</code> 关闭 <code>redis connect</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">Error</span><span class="token operator">:</span> Redis connection to <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">6379</span> failed <span class="token operator">-</span> connect <span class="token constant">ECONNREFUSED</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">6379</span>
    at TCPConnectWrap<span class="token punctuation">.</span>afterConnect <span class="token punctuation">[</span><span class="token keyword">as</span> oncomplete<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token parameter">net<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">1141</span><span class="token operator">:</span><span class="token number">16</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">errno</span><span class="token operator">:</span> <span class="token string">'ECONNREFUSED'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token string">'ECONNREFUSED'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">syscall</span><span class="token operator">:</span> <span class="token string">'connect'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">6379</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="使用-redis-redis-session"><a href="#使用-redis-redis-session" class="header-anchor">#</a> 使用 redis redis-session</h4> <blockquote><p><code>package redis connec-redis express-session resdis &gt; 2x redix@4x</code>导入有错误
使用指定版本号 <code>redis@3.1.2</code></p></blockquote> <ol><li>暴露事件</li></ol> <blockquote><p>每当连接 redis 服务器时都会有事件发生 是个异步过程 不支持原生 promise
需引入 polyify  到过 util工具模块 中的 util.promisify 转为promise 使用</p></blockquote> <ul><li><code>connect</code> 连接</li> <li><code>ready</code> 建立连接后发出</li> <li><code>end</code> 断开</li> <li><code>error</code> 错误</li> <li><code>reconnecting</code> 重连</li> <li><code>warning</code>  在设置密码但不需要密码并且使用不推荐使用的选项/功能/类似时发出</li></ul> <ol start="2"><li><code>redis.createClient()：RedisClient objec</code></li></ol> <ul><li><p>如果 Redis 服务器与客户端在同一台机器上运行，请尽可能考虑使用 <code>unix</code> 套接字以提高吞吐量。</p></li> <li><p>得到服务器实例</p></li> <li><p>同一台机器可能没问题 使用默认值 <code>127.0.0.1 6379</code></p></li> <li><p>使用<code>rediss://...</code>在该协议 redis_url 将使 <code>TLS</code> 套接字连接。但是，<code>options</code> 如果需要，需要传入额外的 <code>TLS</code> 选项</p> <div class="language-js extra-class"><pre class="language-js"><code>redis<span class="token punctuation">.</span><span class="token function">createClient</span><span class="token punctuation">(</span><span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span>
redis<span class="token punctuation">.</span><span class="token function">createClient</span><span class="token punctuation">(</span>unix_socket<span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">)</span>
redis<span class="token punctuation">.</span><span class="token function">createClient</span><span class="token punctuation">(</span>redis_url<span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">)</span>
redis<span class="token punctuation">.</span><span class="token function">createClient</span><span class="token punctuation">(</span>port<span class="token punctuation">[</span><span class="token punctuation">,</span> host<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <h3 id="options-对象可选参数"><a href="#options-对象可选参数" class="header-anchor">#</a> options 对象可选参数</h3> <ul><li><code>host</code> - Redis服务器的IP地址。默认值为：<code>127.0.0.1</code></li> <li><code>port</code> - Redis服务器的端口。默认值为：<code>6379</code></li> <li><code>path</code> - Redis服务器的UNIX套接字路径。默认为：<code>null</code></li> <li><code>url</code> - Redis服务器的 URL。格式为 <code>redis:]//[[user][:password@]]host][:port][/db-number][?db=db-number[&amp;password=bar[&amp;option=value]]]</code>。默认为：<code>null</code></li> <li><code>parser</code> - 使用内置的JS解析或使用hiredis解析，在&lt; 2.6的版本中hiredis会默认被安装。默认为：null</li> <li><code>string_numbers</code> - 设置为true时会返回Redis数字字符串代替JavaScript数字字符串。默认为：null</li> <li><code>return_buffers</code> - 设置为true时会向回调函数返回Buffer而不是字符串。默认为：false</li> <li><code>detect_buffers</code> - 设置为true时会向回调函数返回Buffer而不是字符串，不同于 <code>return_buffers</code>，这个参数会针对每一个命令的基础上进行Buffer和字符串之间进行转换。默认为：false</li> <li><code>socket_keepalive</code> - 设置为true时，会保持socket套接字的连接。默认为：true</li> <li><code>no_ready_check</code> - 当建立到Redis 服务器的连接时，仍可以从磁盘加载数据，加载时服务器不会响应任何命令。为了解决这个问题，node_redis会向服务器发送一个INFO命令以检查服务器的状态。默认为：false</li> <li><code>enable_offline_queue</code> - 默认情况下，当Redis 服务器没有活跃的连接时，这个命令会被添加到队列且会立即执行；当此选项设置为false时，会禁用此功能。默认为：true</li> <li><code>retry_max_delay</code> - 默认情况下，客户端会在上次失败后延时一倍时间再次尝试重连，此选项用于设置尝试重连的时候。默认为：null</li> <li><code>max_attempts</code> - 此选项用于设置客户端连接和重新连接的时间。默认为：<code>3600000</code></li> <li><code>connect_timeout</code> - 不再使用，请用 <code>retry_strategy</code> 选项替代</li> <li><code>retry_unfulfilled_commands</code> - 设置为true时，所有未实现的命令会重新连接后重试。默认为：true</li> <li><code>password</code> - 用于Redis 服务器验证的密码，别名 <code>auth_pass</code>。在&lt; 2.5的版本中必须使用 <code>auth_pass</code>。默认为：null</li> <li><code>db</code> - 设置后会在连接时执行select命令连接到指定数据库。默认为：null</li> <li><code>family</code> - 连接Redis服务器使用的IP协议族，参见Node.js的net模块和nds模块相关介绍。默认为：IPv4</li> <li><code>disable_resubscribing</code> - 设置为true时，客户端断开连接后不会重新订阅。默认为：false</li> <li><code>rename_commands</code> - 传入一个对象，对Redis 命令进行重命名。默认为：null</li> <li><code>tls</code> - 设置连接到Redis 服务器的TLS连接。默认为：null</li> <li><code>prefix</code> - 设置键的前缀。默认为：null</li> <li><code>retry_strategy</code> - 一个包含 <code>attempt</code> 选项的函数，<code>total_retry_time</code> 选项会标识重试的次数。默认为：function</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blogs-muxiao/no-base/envirament/" class="prev">
        环境变量
      </a></span> <span class="next"><a href="/blogs-muxiao/no-base/nginx/">
        Nginx
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blogs-muxiao/assets/js/app.a806e497.js" defer></script><script src="/blogs-muxiao/assets/js/2.78b8a33c.js" defer></script><script src="/blogs-muxiao/assets/js/27.97108fd7.js" defer></script>
  </body>
</html>
